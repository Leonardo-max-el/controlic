{% extends "base.html" %}


{% block content %}

<main class="container" style="width: 700px;">
    <div class="row">
        <div class="col-md-8 offset-md- mt-5" >
                <form  id="inspeccionForm" method="POST" action="/registrar_inspeccion/" class="card card-body">
                {% if user.is_authenticated %}
                <h4 class="text-center" style="font-weight: bold;">Hola, {{ user.username }}. ¿Qué ambiente deseas registrar hoy?</h4>
                {% endif %}
                {% csrf_token %}
                

                <script>
                    function actualizarIdentificadores() {
                        let ambiente = document.getElementById("ambientes").value;
                        let identificador = document.getElementById("identificador");
            
                        // Limpiar las opciones actuales
                        identificador.innerHTML = "";
            
                        // Opciones para cada tipo de ambiente
                        let opciones = {
                            "LABORATORIO DE CÓMPUTO": ["A", "B", "C", "D", "E", "F", "G", "H"],
                            "AULA": ["B101", "B102", "B103", "B104", "B105", "B201", "B202", "B203", "B204", "B205", "B206", "B301", "B302", "B303", "B304", "B305", "B306", "B401", "B403", "B404", "B405", "B406", "B505"],
                            "TALLER": ["DIBUJO", "MODAS", "MÚLTIPLE 1", "MÚLTIPLE 2", "MÚLTIPLE 3"]
                        };
            
                        // Añadir las opciones correspondientes
                        if (opciones[ambiente]) {
                            opciones[ambiente].forEach(opcion => {
                                let opt = document.createElement("option");
                                opt.value = opcion;
                                opt.textContent = opcion;
                                identificador.appendChild(opt);
                            });
                        }
                    }
                </script>
            </head>
            <body>
            
            <div class="row"  style=" margin: 10px 0 10px 0; width: 400px; font-size: 18px; display: flex; font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif; text-align: center;">
                <select name="tipo_ambiente" style="text-align: center; margin-bottom: 10px; font-weight: bold; " id="ambientes" onchange="actualizarIdentificadores()">
                    <option value="" selected disabled>Seleccione un ambiente</option>
                    <option value="LABORATORIO DE CÓMPUTO" autocapitalize="characters">LABORATORIO DE CÓMPUTO</option>
                    <option value="AULA" autocapitalize="characters">AULA</option>
                    <option value="TALLER" autocapitalize="characters">TALLER</option>
                </select>
            
                <label for="identificador"></label>
                <select id="identificador" style="text-align: center;" name="ambiente">
                    <option value="" selected disabled>Seleccione un identificador</option>
                </select>
            </div>

                    <br>
                    <table class="table table-striped table-hover" >
                        <tr style="text-align: center;">
                            <th>Elemento</th>
                            <th >Correcto</th>
                            <th>Observado</th>
                        </tr>
                        <tr>
                            <td>Equipo de Cómputo</td>
                            <td style="text-align: center;"><input type="radio" name="equipo_computo" value="C" checked></td>
                            <td style="text-align: center;"><input type="radio" name="equipo_computo" value="O" style="accent-color: red;"></td>
                        </tr>
                        <tr>
                            <td>Proyector Multimedia</td>
                            <td style="text-align: center;"><input type="radio" name="proyector_multimedia" value="C" checked></td>
                            <td style="text-align: center;"><input type="radio" name="proyector_multimedia" value="O" style="accent-color: red;"></td>
                        </tr>
                        <tr>
                            <td>Red</td>
                            <td style="text-align: center;"><input type="radio" name="red" value="C" checked></td>
                            <td style="text-align: center;"><input type="radio" name="red" value="O" style="accent-color: red;"></td>
                        </tr>
                        <tr>
                            <td>Fluido Eléctrico</td>
                            <td style="text-align: center;"><input type="radio" name="fluido_electrico" value="C" checked></td>
                            <td style="text-align: center;"><input type="radio" name="fluido_electrico" value="O" style="accent-color: red;"></td>
                        </tr>
                        
                        <tr>
                            <td>Orden y Limpieza</td>
                            <td style="text-align: center;"><input type="radio" name="orden_limpieza" value="C" checked></td>
                            <td style="text-align: center;"><input type="radio" name="orden_limpieza" value="O" style="accent-color: red;"></td>
                        </tr>

                        <tr>
                            <td>Módulos</td>
                            <td style="text-align: center;"><input type="radio" name="modulos" value="C" checked></td>
                            <td style="text-align: center;"><input type="radio" name="modulos" value="O" style="accent-color: red;"></td>
                        </tr>

                        <tr>
                            <td>observacion</td>
                            <td>
                                <textarea name="observacion" type="text" id="" cols="30" rows="5" style="font-style: italic; font-size: 12px;" autocapitalize="characters" placeholder="NO SE ENCONTRARON OBSERVACIONES"></textarea>
                            </td>
                        </tr>
                        
                    </table>            
                <button class="btn btn-primary" type="submit">Guardar</button>
            </form>


        </div>
        
        <script>
        document.getElementById("inspeccionForm").addEventListener("submit", function(event) {
            event.preventDefault();

            let formData = new FormData(this);

            fetch("/registrar_inspeccion/", {
                method: "POST",
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                alert(data.mensaje);
                location.reload();
            })
            .catch(error => console.error("Error:", error));
        });
        </script>

        </div>
    </div>
</main>


{% endblock %}